/*! corelib-js 18-10-2013 */
!function(){var a=window.ztesoft=window.ztesoft||{},b=String.prototype,c=b.trim,d=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;a.trim=c?function(a){return null==a?"":c.call(a)}:function(a){return null==a?"":a.replace(d,"")},a.addClass=function(b,c){if(c&&b.setAttribute){var d=(" "+(b.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ");_.each(c.split(" "),function(b){b=a.trim(b),-1===d.indexOf(" "+b+" ")&&(d+=b+" ")}),b.setAttribute("class",a.trim(d))}},a.removeClass=function(b,c){c&&b.setAttribute&&_.each(c.split(" "),function(c){b.setAttribute("class",a.trim((" "+(b.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").replace(" "+a.trim(c)+" "," ")))})},a.on=function(){},a.off=function(){},a.inherit=function(a,b){function c(){}c.prototype=b.prototype,a.superClass_=b.prototype,a.prototype=new c,a.prototype.constructor=a},a.namespace=function(a){for(var b,c=a.split("."),d=window;c.length&&(b=c.shift());)d=d[b]?d[b]:d[b]={};return d}}(),function(){var a=ztesoft.namespace("ztesoft.events"),b=[],c=b.slice;a.Event={on:function(a,b,c){if(!e(this,"on",a,[b,c])||!b)return this;this._events||(this._events={});var d=this._events[a]||(this._events[a]=[]);return d.push({callback:b,context:c,ctx:c||this}),this},once:function(a,b,c){if(!e(this,"once",a,[b,c])||!b)return this;var d=this,f=_.once(function(){d.off(a,f),b.apply(this,arguments)});return f._callback=b,this.on(a,f,c)},off:function(a,b,c){var d,f,g,h,i,j,k,l;if(!this._events||!e(this,"off",a,[b,c]))return this;if(!a&&!b&&!c)return this._events={},this;for(h=a?[a]:_.keys(this._events),i=0,j=h.length;j>i;i++)if(a=h[i],g=this._events[a]){if(this._events[a]=d=[],b||c)for(k=0,l=g.length;l>k;k++)f=g[k],(b&&b!==f.callback&&b!==f.callback._callback||c&&c!==f.context)&&d.push(f);d.length||delete this._events[a]}return this},trigger:function(a){if(!this._events)return this;var b=c.call(arguments,1);if(!e(this,"trigger",a,b))return this;var d=this._events[a],g=this._events.all;return d&&f(d,b),g&&f(g,arguments),this},stopListening:function(a,b,c){var d=this._listeningTo;if(!d)return this;var e=!b&&!c;c||"object"!=typeof b||(c=this),a&&((d={})[a._listenId]=a);for(var f in d)a=d[f],a.off(b,c,this),(e||_.isEmpty(a._events))&&delete this._listeningTo[f];return this}};var d=/\s+/,e=function(a,b,c,e){if(!c)return!0;if("object"==typeof c){for(var f in c)a[b].apply(a,[f,c[f]].concat(e));return!1}if(d.test(c)){for(var g=c.split(d),h=0,i=g.length;i>h;h++)a[b].apply(a,[g[h]].concat(e));return!1}return!0},f=function(a,b){var c,d=-1,e=a.length,f=b[0],g=b[1],h=b[2];switch(b.length){case 0:for(;++d<e;)(c=a[d]).callback.call(c.ctx);return;case 1:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f);return;case 2:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g);return;case 3:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g,h);return;default:for(;++d<e;)(c=a[d]).callback.apply(c.ctx,b)}}}(),function(){function a(a,b){var c=b,d=a.getDate();return d>c.getDate()&&(c=h.addDays(b,-b.getDate())),c}function b(a,b,c){var d=a.getTime()+b*c;return new Date(d)}var c=ztesoft.namespace("ztesoft.utils"),d=1e3,e=60*d,f=60*e,g=24*f,h=c.DateUtil={addMonths:function(b,c){var d=new Date(b.getTime());return d.setMonth(b.getMonth()+c),d=a(b,d)},addDays:function(a,c){return b(a,g,c)},format:function(){}}}(),function(){var a=ztesoft.namespace("ztesoft.components"),b=a.ComboBox=function(a,c){this.element=a,this.textField=this.element.querySelector("input"),this.addOn=this.element.querySelector(".input-group-addon"),_.extend(this,b.DEFAULTS,c),$(this.addOn).on("click",_.bind(this.show,this))};_.extend(b.prototype,ztesoft.events.Event),b.DEFAULTS={labelField:null,labelFunction:null},b.prototype.render=function(){var b=document.createElement("ul");b.setAttribute("class","dropdown-menu"),this.element.appendChild(b),this.list=new a.List(b,{labelField:this.labelField,labelFunction:this.labelFunction,dataSource:this.dataSource}),this.list.render(),this.list.on("itemClick",_.bind(this._itemClickHandler,this))},b.prototype.selectedIndex=function(a){return 0===arguments.length?this._selectedIndex:(this._setSelectedIndex(a),void 0)},b.prototype.selectedItem=function(a){return 0===arguments.length?this._selectedItem:(this._selectedItem=a,void 0)},b.prototype._setSelectedIndex=function(){},b.prototype._itemClickHandler=function(){this._selectedIndex=this.list.selectedIndex(),this._selectedItem=this.list.selectedItem(),this.textField.value=this.list.itemToLabel(this._selectedItem),this.hide()},b.prototype.show=function(){ztesoft.addClass(this.element,"open")},b.prototype.hide=function(){ztesoft.removeClass(this.element,"open")},b.prototype.destory=function(){this.list.remove(),this.addOn.off("click")}}(),function(){var a=ztesoft.namespace("ztesoft.components"),b=a.DatePicker=function(a,c){this.element=a,this.$element=$(a),_.extend(this,b.DEFAULTS,c)};b.DEFAULTS={days:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],formatString:"yyyy-MM-dd",weekStart:0,disabledDays:[],selectableRange:[]},b.prototype.render=function(){this.date=new Date,this._picker=document.createElement("div"),this._picker.className="datepicker-dropdown dropdown-menu",this._picker.innerHTML='<table class="table-condensed"><thead><tr><th class="prev">&laquo;</th><th colspan="5" class="datepicker-switch"></th><th class="next">&raquo;</th></tr></thead><tbody><tr><td colspan="7"></td></tr></tbody></table>',this._updateMonth();for(var a=["<tr>"],b=this.weekStart;b<this.weekStart+7;)a.push('<th class="dow">'+this.days[b]+"</th>"),b++;a.push("</tr>");var c=this._picker.querySelector("thead");c.innerHTML+=a.join(""),this._updateFillDays(),document.body.appendChild(this._picker),this.$element.on("click",_.bind(this.show,this)),$(this._picker).on("click",_.bind(this._clickHandler,this)),$(this._picker).on("dblclick",_.bind(this._okHandler,this)),$(document).on("click",_.bind(this._mouseClickOutsideHandler,this))},b.prototype._updateMonth=function(){this._picker.querySelector(".datepicker-switch").textContent=this.months[this.date.getMonth()]+" "+this.date.getFullYear()},b.prototype._updateFillDays=function(){for(var a=this.date.getFullYear(),b=this.date.getMonth(),c=this._getOffsetOfMonth(a,b),d=this._getNumberOfDaysInMonth(a,b),e=["<tr>"],f=0;c>f;f++)e.push("<td></td>");for(f=1;d>=f;)0==c&&e.push("<tr>"),e.push('<td class="day">'+f+"</td>"),6==c?(e.push("</tr>"),c=0):c++,f++;this._picker.querySelector("tbody").innerHTML=e.join("")},b.prototype._getOffsetOfMonth=function(a,b){var c=new Date(a,b,1),d=c.getDay()-this.weekStart;return 0>d?d+7:d},b.prototype._getNumberOfDaysInMonth=function(a,b){var c;return c=1==b?0==a%4&&0!=a%100||0==a%400?29:28:3==b||5==b||8==b||10==b?30:31},b.prototype._clickHandler=function(a){var b=a.target;if("TD"==b.tagName&&b.textContent){var c=this._picker.querySelector(".active");c&&ztesoft.removeClass(c,"active"),ztesoft.addClass(b,"active")}else"prev"==b.className?(this.date=ztesoft.utils.DateUtil.addMonths(this.date,-1),this._updateMonth(),this._updateFillDays()):"next"==b.className&&(this.date=ztesoft.utils.DateUtil.addMonths(this.date,1),this._updateMonth(),this._updateFillDays())},b.prototype._okHandler=function(a){var b=a.target;if("TD"==b.tagName&&b.textContent){this.date.setDate(parseInt(b.textContent));var c=this.date.getFullYear(),d=this.date.getMonth()+1,e=this.date.getDate();10>d&&(d="0"+d),10>e&&(e="0"+e),this.element.value=c+"-"+d+"-"+e,this.hide()}},b.prototype._mouseClickOutsideHandler=function(a){a.target==this.element||a.target==this._picker||this._picker.contains(a.target)||this.hide()},b.prototype.place=function(){var a=this.element.getBoundingClientRect();this._picker.style.left=a.left+"px",this._picker.style.top=a.top+a.height+"px"},b.prototype.show=function(){this._picker.style.display="block",this.place()},b.prototype.hide=function(){this._picker.style.display="none"},b.prototype.destory=function(){this._picker.remove()}}(),function(){var a=ztesoft.namespace("ztesoft.components"),b=a.List=function(a,c){this.dataSource=null,this._selectedItem=null,this._selectedIndex=-1,this.element=a,this.$element=$(a),_.extend(this,b.DEFAULTS,c)};_.extend(b.prototype,ztesoft.events.Event),b.prototype.render=function(){var a=this,b=[];_.each(this.dataSource,function(c){b.push("<li><a>"+a.itemToLabel(c)+"</a></li>")}),this.element.innerHTML=b.join(""),this.$element.on("click",_.bind(this._clickHandler,this))},b.prototype.itemToLabel=function(a){return a?null!=this.labelFunction?this.labelFunction(a):null!=this.labelField?a(this.labelField):a:""},b.prototype.selectedIndex=function(a){return 0===arguments.length?this._selectedIndex:(this._setSelectedIndex(a),void 0)},b.prototype.selectedItem=function(a){return 0===arguments.length?this._selectedItem:(this.selectedIndex(_.indexOf(this.dataSource,a)),void 0)},b.prototype.append=function(a){var b=document.createElement("li");b.innerHTML=this.itemToLabel(a),this.element.appendChild(b),this.dataSource.push(a)},b.prototype.appendAt=function(a,b){var c=document.createElement("li");c.innerHTML=this.itemToLabel(a);var d=this.element.children[b];this.element.insertBefore(c,d),this.dataSource.splice(b,0,a)},b.prototype.remove=function(a){this.element.removeChild(this.element.children[a]),this.dataSource.splice(a,1)},b.prototype.update=function(a){var b=_.indexOf(this.dataSource,a),c=this.element.children[b];c.innerHTML=this.itemToLabel(a)},b.prototype.destory=function(){this.element.remove()},b.prototype.seekSelectedItem=function(a){var b,c=-1,d=this.dataSource.length;if(this.dataKeyField){for(b=0;d>b;b++)if(this.dataSource[b][dataKeyField]==a){c=b;break}}else for(b=0;d>b;b++)if(this.dataSource[b]==a){c=b;break}-1!=c&&this._setSelectedIndex(c)},b.prototype._setSelectedIndex=function(a){var b=this._selectedIndex;if(b!==a){var c=this.element.children;-1!==b&&ztesoft.removeClass(c[b],"active"),ztesoft.addClass(c[a],"active"),this._selectedIndex=a,this._selectedItem=this.dataSource[a],this.trigger("change")}},b.prototype._clickHandler=function(a){if("A"===a.target.tagName){var b=_.indexOf(this.element.children,a.target.parentElement);this.selectedIndex(b),this.trigger("itemClick")}},b.DEFAULTS={rowCount:6,labelField:null,labelFunction:null,dataKeyField:null}}(),function(){var a=ztesoft.namespace("ztesoft.components"),b=a.NumericStepper=function(a,c){_.extend(this,b.DEFAULTS,c)};_.extend(b.prototype,ztesoft.events.Events),b.prototype.value=function(a){return 0===arguments.length?this._value:(this._setValue(a),void 0)},b.prototype._setValue=function(a){this.inputField.text=a,this._value=a,this.trigger("change")},b.DEFAULTS={minimum:0,maximum:10,stepSize:1}}(),function(){var a=ztesoft.namespace("ztesoft.components"),b=a.TabNavigator=function(a){this.element=a,this.tabBar=this.element.querySelector(".nav"),this.tabConent=this.element.querySelector(".tab-content"),this._selectedIndex=0,$(this.tabBar).on("click",_.bind(this._tabClickHandler,this))};_.extend(b.prototype,ztesoft.events.Event),b.prototype.selectedIndex=function(a){return 0===arguments.length?this._selectedIndex:(this._setSelectedIndex(a),void 0)},b.prototype._setSelectedIndex=function(a){var b=this._selectedIndex;if(b!==a){var c=this.tabBar.children;-1!==b&&(ztesoft.removeClass(c[b],"active"),ztesoft.removeClass(this.tabConent.querySelector(c[b].firstChild.getAttribute("href")),"active")),ztesoft.addClass(c[a],"active"),ztesoft.addClass(this.tabConent.querySelector(c[a].firstChild.getAttribute("href")),"active"),this._selectedIndex=a,this.trigger("change")}},b.prototype._tabClickHandler=function(a){var b=a.target;"A"==b.tagName&&(a.preventDefault(),this._setSelectedIndex(_.indexOf(this.tabBar.children,b.parentElement)))}}(),function(){var a=ztesoft.namespace("ztesoft.components"),b=a.ViewStack=function(a){this.element=a;var b=this.element.querySelector(".active");this._selectedIndex=b?_.indexOf(this.element.children,b):-1};_.extend(b.prototype,ztesoft.events.Event),b.prototype.selectedIndex=function(a){return 0===arguments.length?this._selectedIndex:(this._setSelectedIndex(a),void 0)},b.prototype.append=function(){this.element.appendChild(li)},b.prototype.appendAt=function(a,b){var c=this.element.children[b];this.element.insertBefore(a,c)},b.prototype._setSelectedId=function(){var a=this.element.querySelector(".active");this._setSelectedIndex(this.element.children.indexOf(a))},b.prototype._setSelectedIndex=function(a){var b=this._selectedIndex;if(b!==a){var c=this.element.children;-1!==b&&ztesoft.removeClass(c[b],"active"),ztesoft.addClass(c[a],"active"),this._selectedIndex=a,this.trigger("change")}}}();